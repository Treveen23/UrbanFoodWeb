-- Customer Table (Complete customer information)
CREATE TABLE CUSTOMERS (
    CustomerID NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    FirstName VARCHAR2(100) NOT NULL,
    LastName VARCHAR2(100) NOT NULL,
    Email VARCHAR2(100) NOT NULL UNIQUE,
    PhoneNumber VARCHAR2(20) NOT NULL,
    Password VARCHAR2(100) NOT NULL,
    Address VARCHAR2(100) NOT NULL,
    DietaryPreference VARCHAR2(50)
);

CREATE TABLE SUPPLIERS (
    SupplierID NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    FirstName VARCHAR2(100) NOT NULL,
    LastName VARCHAR2(100) NOT NULL,
    Email VARCHAR2(100) NOT NULL UNIQUE,
    PhoneNumber VARCHAR2(20) NOT NULL,
    Password VARCHAR2(100) NOT NULL,
    Address VARCHAR2(100) NOT NULL,
    BusinessName VARCHAR2(100) NOT NULL,
    BusinessType VARCHAR2(50) NOT NULL
);

-- Create Categories table
CREATE TABLE Categories (
    CategoryId NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    CategoryName VARCHAR2(100) NOT NULL,
    Description VARCHAR2(500),
    ImagePath VARCHAR2(255) NOT NULL,
    IsActive NUMBER(1) DEFAULT 1 NOT NULL,
    CreatedDate TIMESTAMP DEFAULT SYSTIMESTAMP NOT NULL,
    ModifiedDate TIMESTAMP
);

ALTER TABLE Categories
ADD CONSTRAINT uq_CategoryName UNIQUE (CategoryName);

CREATE TABLE Products (
    ProductID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    SupplierID NUMBER NOT NULL,
    CategoryID NUMBER NOT NULL,
    ProductName VARCHAR2(100) NOT NULL,
    Description VARCHAR2(1000),
    Price NUMBER(10,2) NOT NULL,
    QuantityAvailable NUMBER DEFAULT 0,
    IsActive NUMBER(1) DEFAULT 1 CHECK (IsActive IN (0,1)),
    IsFeatured NUMBER(1) DEFAULT 0 CHECK (IsFeatured IN (0,1)),
    DateAdded DATE DEFAULT SYSDATE,
    ImageURL VARCHAR2(255),  -- Added to store the primary product image URL
    CONSTRAINT fk_product_supplier FOREIGN KEY (SupplierID) REFERENCES Suppliers(SupplierID),
    CONSTRAINT fk_product_category FOREIGN KEY (CategoryID) REFERENCES Categories(CategoryID)
);

CREATE TABLE ShoppingCart (
    CartID NUMBER PRIMARY KEY,
    CustomerID NUMBER NOT NULL,
    ProductID NUMBER NOT NULL,
    Quantity NUMBER DEFAULT 1,
    DateAdded DATE DEFAULT SYSDATE,
    CONSTRAINT fk_customer FOREIGN KEY (CustomerID) REFERENCES Customers(CustomerID),
    CONSTRAINT fk_product FOREIGN KEY (ProductID) REFERENCES Products(ProductID)
);

CREATE SEQUENCE cart_seq START WITH 1 INCREMENT BY 1;

-- Create Orders Table
CREATE TABLE Orders (
    OrderID NUMBER PRIMARY KEY,
    CustomerID NUMBER NOT NULL,
    OrderDate DATE DEFAULT SYSDATE,
    ShippingAddress VARCHAR2(500),
    BillingAddress VARCHAR2(500),
    Subtotal NUMBER(10,2),
    ShippingCost NUMBER(10,2),
    TotalAmount NUMBER(10,2),
    PaymentMethod VARCHAR2(50),
    OrderStatus VARCHAR2(50) DEFAULT 'Pending',
    CONSTRAINT fk_order_customer FOREIGN KEY (CustomerID) REFERENCES Customers(CustomerID)
);

CREATE SEQUENCE order_seq START WITH 1 INCREMENT BY 1;

-- Create OrderItems Table
CREATE TABLE OrderItems (
    OrderItemID NUMBER PRIMARY KEY,
    OrderID NUMBER NOT NULL,
    ProductID NUMBER NOT NULL,
    Quantity NUMBER,
    Price NUMBER(10,2),
    CONSTRAINT fk_orderitem_order FOREIGN KEY (OrderID) REFERENCES Orders(OrderID),
    CONSTRAINT fk_orderitem_product FOREIGN KEY (ProductID) REFERENCES Products(ProductID)
);

CREATE SEQUENCE orderitem_seq START WITH 1 INCREMENT BY 1;


CREATE TABLE Deliveries (
    DeliveryID NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    OrderID NUMBER NOT NULL,
    RequestDate DATE DEFAULT SYSDATE,
    DeliveryDate DATE,
    Status VARCHAR2(50) DEFAULT 'Pending',
    Notes VARCHAR2(500),
    CONSTRAINT fk_delivery_order FOREIGN KEY (OrderID) REFERENCES Orders(OrderID)
);




